/*! customImg-plugin - 1.0.235 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],t):"object"==typeof exports?exports["customImg-plugin"]=t(require("grapesjs")):e["customImg-plugin"]=t(e.grapesjs)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(a){if(i[a])return i[a].exports;var r=i[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),s=a(r),n=i(2),l=a(n),o=i(3),c=a(o),d=i(4),u=a(d);t.default=s.default.plugins.add("customImg-plugin",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t,a={};for(var r in a)r in i||(i[r]=a[r]);(0,l.default)(e,i),(0,c.default)(e,i),(0,u.default)(e,i)})},function(t,i){t.exports=e},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){function t(e,t){if(0==t.indexOf("#"))return noTrackedLinks;var i=e.trim();return""==i&&(i=t.trim()),i=i.replace("http://",""),i=i.replace("www.",""),i=i.replace(/\W/g,""),i.trim().substring(0,45)}var i=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.DomComponents),r=i.getType("link"),s=r.model,n=r.view;i.addType("customImg",{model:s.extend({defaults:Object.assign({},s.prototype.defaults,{activeOnRender:!0,highlightable:!1,droppable:!1,editable:!1,resizable:!0,badgable:!1,traits:[{type:"text"},{type:"text",label:"Image URL",name:"src",changeProp:1},{type:"text",label:"Image Description",name:"alt",changeProp:1},{type:"text",label:"Destination URL",name:"href",placeholder:"http://www.example.com",changeProp:1},{type:"checkbox",label:"Track Clicks",name:"trackClicks",changeProp:1,id:"test"},{type:"text",label:"Reporting Name",name:"name",changeProp:1},{type:"buttonGroup",name:"buttonGroup",label:"",changeProp:1}]}),initialize:function(){s.prototype.initialize.apply(this,arguments),this.listenTo(this,"active",this.doOnDropStuff),this.on("destroy",this.handleRemove),this.get("isdrop")||this.set({style:{}})},handleRemove:function(){e.Panels.getButton("views","open-blocks").set("active",1)},doOnDropStuff:function(t,i){e.select(this),e.Panels.getButton("views","open-tm").set("active",1),updateMediaLibaryTrait()},updateDimensions:function(e,t){var i=new Image;i.src=t,i.complete?this.imgLoaded(i.width,i.height,e):i.addEventListener("load",this.imgLoaded)},imgLoaded:function(t,i,r){var s=0,n=0,l="";"object"===(void 0===t?"undefined":a(t))?(r=e.getSelected(),s=t.target.width,n=t.target.height):(s=t,n=i);for(var o=r.get("classes").models,c=0;c<o.length;c++)"customImg"!=o[c].id&&(l=o[c].id);if(0!=n){try{var d=e.SelectorManager,u=d.add("customImg"),h=d.add(l);e.CssComposer.get([u,h]).set("style",{display:"inline-block",width:s+"px",height:n+"px"}),r.view.render()}catch(e){console.log(e)}e.select(),e.select(r)}},updateSrc:function(e,t){e.view.$el.find("img").attr("src",t),e.view.$el.find("img").attr("data-cke-saved-src",t);var i=e.view.$el.find("img").attr("id");if(this.attributes.components.models.length)try{var a,r=this.view.$el.find("img").attr("alt");this.attributes.components.models[0].get("attributes");a=null!=i?{src:t,alt:r,id:i}:{src:t,alt:r},this.attributes.components.models[0].set("attributes",a),this.attributes.components.models[0].attributes.src=t}catch(e){}else this.set("content",e.view.el.children[0].outerHTML);this.view.render()},updateHref:function(e,i){var a=e.view.el.style.width,r=e.view.el.style.height;if(null==e.view.$el.attr("name")){var s=t("",i);e.view.$el.attr("name",s)}e.view.$el.attr("href",i);try{var n=this.view.$el.attr("href"),l=this.view.$el.attr("class"),o=(this.view.$el.attr("name"),this.get("attributes"),{name:name,class:l,href:n});this.set("attributes",o),this.attributes.href=n}catch(e){}this.view.render(),e.view.el.style.width=a,e.view.el.style.height=r},updateName:function(e,t){var i=e.view.el.style.width,a=e.view.el.style.height;e.view.$el.attr("name",t);try{var r=this.view.$el.attr("name"),s=this.view.$el.attr("class"),n=(this.get("attributes"),{name:r,class:s});this.set("attributes",n),this.attributes.name=r}catch(e){}this.view.render(),e.view.el.style.width=i,e.view.el.style.height=a},updateAlt:function(e,t){var i=e.view.el.style.width,a=e.view.el.style.height;e.view.$el.find("img").attr("alt",t);var r=e.view.$el.find("img").attr("id");if(this.attributes.components.models.length)try{var s,n=this.view.$el.find("img").attr("src");this.attributes.components.models[0].get("attributes");s=null!=r?{src:n,alt:t,id:r}:{src:n,alt:t},this.attributes.components.models[0].set("attributes",s),this.attributes.components.models[0].attributes.src=n}catch(e){}else this.set("content",e.view.el.children[0].outerHTML);this.view.render(),e.view.el.style.width=i,e.view.el.style.height=a},updateTrackedLink:function(i,a){var r=i.view.el.style.width,s=i.view.el.style.height,n="";if(a)if(null!=(n=e.TraitManager.getTraitsViewer().collection.models[5].attributes.value)&&""!=n&&"LinkIsNotTracked"!=n)i.view.$el.attr("name",n);else{var l=i.view.$el.attr("href");null!=l?(n=t("",l),i.view.$el.attr("name",n)):i.view.$el.removeAttr("name")}else n="LinkIsNotTracked";try{var l=this.view.$el.attr("href"),o=this.view.$el.attr("class"),c=(this.get("attributes"),{name:n,class:o,href:l});this.set("attributes",c),this.attributes.name=n,e.TraitManager.getTraitsViewer().collection.models[5].setTargetValue(n),e.TraitManager.getTraitsViewer().render(),updateMediaLibaryTrait()}catch(e){}this.view.render(),i.view.el.style.width=r,i.view.el.style.height=s},restoreTraits:function(){}},{isComponent:function(e){if($(e).is("a")&&$(e).find("img").length||$(e).hasClass("customImg"))return{type:"customImg"}}}),view:r.view.extend({events:{click:"openSettings"},openSettings:function(t){t.preventDefault(),e.select(this.model),e.Panels.getButton("views","open-tm").set("active",1);var i=t.target.style.width,a=t.target.style.height;try{var r=this.model.attributes.components.models[0].attributes.src;e.TraitManager.getTraitsViewer().collection.models[1].setTargetValue(r)}catch(e){}try{var s=this.model.attributes.components.models[0].attributes.attributes.alt;null!=s&&"null"!=s||(s=""),e.TraitManager.getTraitsViewer().collection.models[2].setTargetValue(s)}catch(e){}try{var n=this.model.attributes.attributes.href;null==n&&(n=""),e.TraitManager.getTraitsViewer().collection.models[3].setTargetValue(n)}catch(e){}try{var l=this.model.get("attributes").name;null==l&&(l=""),e.TraitManager.getTraitsViewer().collection.models[5].setTargetValue(l),"LinkIsNotTracked"==l||""==l||null==l?e.TraitManager.getTraitsViewer().collection.models[4].setTargetValue(!1):e.TraitManager.getTraitsViewer().collection.models[4].setTargetValue(!0)}catch(e){}this.model.unset(r),e.TraitManager.getTraitsViewer().render(),t.target.style.width=i,t.target.style.height=a,updateMediaLibaryTrait()},render:function(e,t){return n.prototype.render.apply(this,arguments),this.$el.attr("onmousedown","return false"),this}})})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.BlockManager.add("customImg-block",{label:"Image",attributes:{class:"gjs-fonts gjs-f-image"},content:'<a class="customImg" style="display:inline-block; width:150; height:150;" data-gjs-isdrop="1">\n                <img src="../images/imgPlaceholder150x150.png" class="linkImage" style="min-width:100%; min-height:100%; max-width: 100%; max-height: 100%;"></img>\n              </a> \n              <style>\n                @media (max-width: 470px) {\n                  .customImg {\n                    width: 100% !important;\n                    display: inline !important;\n                    height: auto !important;\n                    border: 0;\n                    text-decoration: none;\n                  }\n                }\n              </style>\n              '})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.TraitManager.addType("buttonGroup",{events:{click:"onClick"},getInputEl:function(){if(!this.inputEl){var e=document.createElement("div"),t=document.createElement("button");t.setAttribute("class","btnUpdate"),t.innerHTML="OK",t.id="btnUpdate";var i=document.createElement("button");i.setAttribute("class","btnCancel"),i.innerHTML="Cancel",i.id="btnCancel";var a=this.$el.children()[1];$(a).removeClass("gjs-field"),e.appendChild(t),e.appendChild(i),this.inputEl=e}return this.inputEl},onClick:function(e){"btnUpdate"==e.target.id?this.doUpdate():"btnCancel"==e.target.id&&this.doCancel()},doUpdate:function(){var t=e.getSelected();null!=t&&t.view.el.children[0].src;var i=this.model.collection.models[1].get("value"),a=this.model.collection.models[2].get("value"),r=this.model.collection.models[3].get("value"),s=this.model.collection.models[4].get("value"),n=this.model.collection.models[5].get("value");this.target.updateSrc(this.target,i),this.target.updateAlt(this.target,a),this.target.updateHref(this.target,r),this.target.updateName(this.target,n),this.target.updateTrackedLink(this.target,s),this.target.updateDimensions(this.target,i)},doCancel:function(){var t=this.target.view.$el.children().first().attr("src");e.TraitManager.getTraitsViewer().collection.models[1].setTargetValue(t);var i=this.target.view.$el.children().first().attr("alt");e.TraitManager.getTraitsViewer().collection.models[2].setTargetValue(i);var a=this.target.attributes.attributes.href;e.TraitManager.getTraitsViewer().collection.models[3].setTargetValue(a);var r=this.target.attributes.attributes.name;e.TraitManager.getTraitsViewer().collection.models[5].setTargetValue(r),""==r||null==r||"LinkIsNotTracked"==r?e.TraitManager.getTraitsViewer().collection.models[4].setTargetValue(!1):e.TraitManager.getTraitsViewer().collection.models[4].setTargetValue(!0),e.TraitManager.getTraitsViewer().render(),updateMediaLibaryTrait()},renderLabel:function(){this.$el.html('<div class="'+this.labelClass+'"></div>')},onValueChange:function(){}})}}])});